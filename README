chalow - CHAngeLog On the Web - convert ChangeLog to HTML files

ChangeLog を HTML に変換するツール

README

$Id: README,v 1.12 2003/01/18 01:53:09 yto Exp $

----------------------------------------------------------------------
まずは、やってみよう!
----------------------------------------------------------------------

このファイルのあるディレクトリで、以下のコマンドを実行してみて下さい。

| % ./chalow -o sample sample/ChangeLog

これにより、sample/ChangeLog という ChangeLog 形式の日記ファイルが、
sample ディレクトリ以下の複数の HTML ファイルに変換されました。

| % ls sample/*.html
| sample/2001-11.html  sample/2001-12.html  sample/index.html

sample/index.html を Web ブラウザで見てみましょう。

また、以下のコマンドを実行すると、CSS を使った Web 日記になります。

| ./chalow -o sample -c cl.conf sample/ChangeLog


----------------------------------------------------------------------
概要
----------------------------------------------------------------------

ChangeLog の記述内容から、「インデックスページ (※1)」「月ページ (※2)」
を作成し、「出力先ディレクトリ (※3)」に出力する。

※1 インデックスページ (index.html): 日記タイトル、各月ページへのリン
ク、最近数日分の記述が含まれるページ。

※2 月ページ (例: 2001-11.html): ファイル名は、"年-月.html" というフォー
マット。その月の全記述が含まれるぺージ。

※3 出力先ディレクトリ: ChangeLog から変換された HTML ファイルが出力さ
れる先。デフォルトでは現在のディレクトリ。


----------------------------------------------------------------------
使い方
----------------------------------------------------------------------

usage: chalow [options] <file> [file]...
    -n, --top-n=NUM             write NUM days to "index.html"
    -o, --output-dir=DIR        directory to output
    -c, --configure-file=FILE   configure file (default "cl.conf")
    -q, --quiet                 quiet mode

-n で、「インデックスページ」に最近の何日分を載せるか指定できる。
-o で、「出力先ディレクトリ」を指定する。存在しないディレクトリを指定
   してはいけない。
-c で、「ユーザ設定ファイル」を指定する。指定しないとデフォルトの設定。
-q を指定すると、変換作業進捗情報を標準出力に出力しなくなる。

なお、chalow の実行には、nkf が必要。


実行例:

- カレントディレクトリに HTML ファイルを出力する
  | % ./chalow ChangeLog

- インデックスページに最近 2 日分だけ出力する
  | % ./chalow -n 2 -o sample sample/ChangeLog

- ユーザ設定ファイルを使う
  | % ./chalow -c cl.conf -o ~/www/tools/chalow/cl ChangeLog


----------------------------------------------------------------------
ユーザ設定ファイル
----------------------------------------------------------------------

ユーザ設定ファイル ("-c" で指定する) では以下の項目を指定できる。

- 日記の名前
- 自分のホームーページのURL、呼び名
- HTML ファイルの出力先ディレクトリ
- インデックスページ (index.html) で最近何日分を表示するか
- 各項目 (※4) の見出しの文字の色
- インデックスページのヘッダ、フッタ
- 月ページのヘッダ、フッタ (※5) 
- 自動文字列置換 (※6) 
- CSS ファイル
- 月ページに表示する日付の順番 (降順 or 昇順) の調整

※4 「項目」とは、'*' で始まる一塊のテキスト。「項目の見出し」とは '*' 
の後から始まり ':' の前までのテキスト。

  例: "* これが項目の見出しだ: "

※5 月ページのヘッダとフッタは $month_page_header, $month_page_footer 
で設定する。そこでは以下にあげる文字列は自動的に置き換えられる。

  YEARMONTH → その月ページの年月を表す文字列 (例: "2002-10")
  CLNAVI → 月ページ移動ナビ (前後の月ページへのリンク) "<<< >>>"
  DAYLIST → その月ページ内の日付へのリンク (日付一覧)

  例: $month_page_header = "CLNAVI <a href=\"index.html\">Index</a>
  <h1>$changelog_name YEARMONTH</h1><p>DAYLIST</p>\n";

※6 「自動文字列置換」は、ChangeLog 中の文字列を任意の文字列に変換して
いときに用いる。要するに perl のプログラムを書いておくと HTML への変換
のときに適用してくれるというわけ。

  例: "NAISTO" を "<a href="http://nais.to/">NAISTO</a>" に、
  "google" を "<a href="http://www.google.com/">google</a>" 
  に変換する。

  $auto_replace = '
  s!(NAISTO)!<a href="http://nais.to/">$1</a>!g;
  s!(\sgoogle\s)!<a href="http://www.google.com/">$1</a>!g;
  ';

- Tips: 「自動文字列置換」によるキーワードの強調: 強調したい文字列
  を "[[" "]]" で囲むと強調表示される。
  - 例: ええと、[[うぴ]]、つまり、[[強調]]しちゃったりして。

  $auto_replace = '
    s|\[\[(.+?)\]\]|<b>$1</b>|gms;
  ';


----------------------------------------------------------------------
ChangeLog の特殊な記法
----------------------------------------------------------------------

- 秘密の項目: ChangeLog には記したいが、Web 日記として公開するときには
  削りたい項目は、以下のように「項目の見出し」の先頭に "p:" を付ける。
  (p は private の意味)

	* p:秘密メモ: YTがまたやらかした。しょうもないやつだ。


- 日付で参照リンク: "[YYYY-MM-DD]" という文字列は、自動的に過去の項目
  への参照リンクへ変換される。

	先日[2001-12-01]、どこかへ行った。
	↓
	先日<a href="2001-12.html#2001-12-01">[2001-12-01]</a>、
	どこかへ行った。


- URL 表記: "http://...." という文字列は、自動的に 
  "<a href="http://....">http://....</a>" に変換される。

  長い URL は、バックスラッシュ('/')で途中改行することができる。下記の
  例のように変換される。

	http://example.com/123456789012345678901234567890\
	123456789012345678901234567890.html
	↓
	<a href="http://example.com/...0.html>http://example.com/...890
	123456789012345678901234567890.html</a>


- 画像張り付け: "[IMG:画像ファイルのパス]" という文字列は、
  "<img src="画像ファイルのパス">" に変換される。

	今日の写真 → [IMG:image/2000-06-20-08-32-57.m.jpg]
	↓
	今日の写真 → <img src="image/2000-06-20-08-32-57.m.jpg">


- HTML タグ: ChangeLog 中に書かれた、HTML タグ、例えば、
  "<u>" は、"&lt;u&gt;" に変換される。ただし、コメントアウトの
  表記 (<!-- abc -->) だけは変換されない。

	<u>Hello</u> <!-- こんにちは -->
	↓
	&lt;u&gt;Hello&lt;/u&gt; <!-- こんにちは -->


----------------------------------------------------------------------
注意
----------------------------------------------------------------------

ChengaLog ファイルの日付行は、以下のフォーマットでなければならない。

|  2001-11-21  YAMASHITA Tatsuo  <yto@nais.to>
or
|  2001-11-21 (Wed)  YAMASHITA Tatsuo  <yto@nais.to>

曜日入り日付フォーマットについては、
<http://namazu.org/~satoru/diary/?200301b&to=200301151#200301151>
を参照されたい。

以下のフォーマットはサポートしていない。

|  Sat Mar 14 08:48:56 1998  YAMASHITA Tatsuo  <yto@nais.to>

パッケージに含まれている clweek.pl で日付フォーマットの変換ができる。
使い方: 
| % ./clweek.pl ChangeLog > ChangeLog-new
